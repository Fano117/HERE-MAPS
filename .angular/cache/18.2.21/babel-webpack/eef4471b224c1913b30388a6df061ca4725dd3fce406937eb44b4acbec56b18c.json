{"ast":null,"code":"import { BehaviorSubject } from 'rxjs';\nimport * as i0 from \"@angular/core\";\nexport let AddressService = /*#__PURE__*/(() => {\n  class AddressService {\n    constructor() {\n      this.addresses = new BehaviorSubject([]);\n      this.addresses$ = this.addresses.asObservable();\n      this.loadStoredAddresses();\n    }\n    loadStoredAddresses() {\n      const stored = localStorage.getItem('here_maps_addresses');\n      if (stored) {\n        try {\n          const addresses = JSON.parse(stored);\n          this.addresses.next(addresses);\n        } catch (error) {\n          this.addresses.next([]);\n        }\n      }\n    }\n    saveAddresses(addresses) {\n      localStorage.setItem('here_maps_addresses', JSON.stringify(addresses));\n      this.addresses.next(addresses);\n    }\n    addAddress(address) {\n      // Validar que las coordenadas sean válidas antes de guardar\n      if (!this.isValidCoordinate(address.coordinates)) {\n        console.warn('Rejecting address with invalid coordinates:', address);\n        return;\n      }\n      const currentAddresses = this.addresses.value;\n      const existingIndex = currentAddresses.findIndex(a => a.id === address.id);\n      if (existingIndex >= 0) {\n        currentAddresses[existingIndex] = address;\n      } else {\n        currentAddresses.push(address);\n      }\n      this.saveAddresses(currentAddresses);\n    }\n    isValidCoordinate(coord) {\n      // Verificar que sean números válidos\n      if (isNaN(coord.lat) || isNaN(coord.lng)) return false;\n      // Verificar rangos globales básicos\n      if (coord.lat < -90 || coord.lat > 90) return false;\n      if (coord.lng < -180 || coord.lng > 180) return false;\n      // Verificar que estén dentro del área metropolitana de Ciudad de México\n      const bounds = {\n        minLat: 19.0,\n        maxLat: 19.8,\n        minLng: -99.5,\n        maxLng: -98.8\n      };\n      return coord.lat >= bounds.minLat && coord.lat <= bounds.maxLat && coord.lng >= bounds.minLng && coord.lng <= bounds.maxLng;\n    }\n    removeAddress(addressId) {\n      const currentAddresses = this.addresses.value;\n      const filteredAddresses = currentAddresses.filter(a => a.id !== addressId);\n      this.saveAddresses(filteredAddresses);\n    }\n    getAddresses() {\n      return this.addresses.value;\n    }\n    clearAllAddresses() {\n      this.saveAddresses([]);\n    }\n    static {\n      this.ɵfac = function AddressService_Factory(__ngFactoryType__) {\n        return new (__ngFactoryType__ || AddressService)();\n      };\n    }\n    static {\n      this.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n        token: AddressService,\n        factory: AddressService.ɵfac,\n        providedIn: 'root'\n      });\n    }\n  }\n  return AddressService;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}